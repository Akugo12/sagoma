<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SAGOMA CBO Registration Form</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f0f2f5;
    padding: 40px;
  }
  .form-container {
    max-width: 600px;
    margin: auto;
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }
  h2 {
    text-align: center;
    color: #008080;
    margin-bottom: 25px;
  }
  label {
    display: block;
    margin-bottom: 6px;
    font-weight: bold;
  }
  input, select, textarea {
    width: 100%;
    padding: 10px;
    margin-bottom: 20px;
    border: 1px solid #ccc;
    border-radius: 5px;
    box-sizing: border-box;
    font-size: 15px;
  }
  input:focus, select:focus, textarea:focus {
    border-color: #008080;
    outline: none;
  }
  button {
    padding: 12px 20px;
    background-color: #008080;
    color: white;
    border: none;
    border-radius: 5px;
    font-size: 16px;
    cursor: pointer;
    margin-right: 10px;
  }
  button:hover {
    background-color: #006666;
  }
  #disabilitydesc-label, #disabilitydesc {
    display: none;
  }
  .buttons {
    text-align: center;
  }
  img.logo {
    display: block;
    margin: 0 auto 20px auto;
    max-width: 150px;
  }
</style>
</head>
<body>

<div class="form-container">
  <img src="images/i11.jpg" alt="Kenya Logo" class="logo" />
  <h2>SAGOMA CBO Registration Form</h2>
  <form id="registrationForm" onsubmit="return handleSubmit(event)" novalidate>
    <label for="fullname">Full Name</label>
    <input type="text" id="fullname" name="fullname" required />

    <label for="gender">Gender</label>
    <select id="gender" name="gender" required>
      <option value="">-- Select Gender --</option>
      <option value="Male">Male</option>
      <option value="Female">Female</option>
      <option value="Other">Other</option>
    </select>

    <label for="age">Age</label>
    <input type="number" id="age" name="age" min="0" max="120" required />
    <label for="nokcontact">Contact</label>
    <input type="tel" id="nokcontact" name="nokcontact" pattern="[0-9]{9,15}" placeholder="e.g. 0712345678" required />


    <label for="religion">Religion</label>
    <input type="text" id="religion" name="religion" required />

    <label for="education">Education Level</label>
    <select id="education" name="education" required>
      <option value="">-- Select Education Level --</option>
      <option>None</option>
      <option>Primary</option>
      <option>Secondary</option>
      <option>Certificate</option>
      <option>Diploma</option>
      <option>Bachelor's Degree</option>
      <option>Master's Degree</option>
      <option>PhD</option>
      <option>Other</option>
    </select>

    <label for="profession">Profession</label>
    <select id="profession" name="profession" required>
      <option value="">-- Select Profession --</option>
      <option>Farmer</option>
      <option>Teacher</option>
      <option>Doctor</option>
      <option>Engineer</option>
      <option>Trader</option>
      <option>Student</option>
      <option>Business Owner</option>
      <option>Driver</option>
      <option>Police Officer</option>
      <option>Civil Servant</option>
      <option>Unemployed</option>
      <option>Other</option>
    </select>

    <label for="county">County</label>
    <select id="county" name="county" required onchange="populateSubcounties()">
      <option value="">-- Select County --</option>
    </select>

    <label for="subcounty">Subcounty</label>
    <select id="subcounty" name="subcounty" required>
      <option value="">-- Select Subcounty --</option>
    </select>

    <label for="ward">Ward</label>
    <input type="text" id="ward" name="ward" required />

    <label for="location">Location</label>
    <input type="text" id="location" name="location" required />

    <label for="sublocation">Sub Location</label>
    <input type="text" id="sublocation" name="sublocation" required />

    <label for="disability">Disability</label>
    <select id="disability" name="disability" onchange="toggleDisabilityDesc()" required>
      <option value="">-- Select Option --</option>
      <option value="No">No</option>
      <option value="Yes">Yes</option>
    </select>

    <label for="disabilitydesc" id="disabilitydesc-label">If yes, describe</label>
    <textarea id="disabilitydesc" name="disabilitydesc" rows="3"></textarea>

    <label for="nokname">Next of Kin Name</label>
    <input type="text" id="nokname" name="nokname" required />

    <label for="nokcontact">Next of Kin Contact</label>
    <input type="tel" id="nokcontact" name="nokcontact" pattern="[0-9]{9,15}" placeholder="e.g. 0712345678" required />

    <label for="nationalid">National ID Number</label>
    <input type="text" id="nationalid" name="nationalid" pattern="[0-9]{7,10}" required placeholder="e.g. 12345678" />

    <label for="regdate">Registration Date</label>
    <input type="date" id="regdate" name="regdate" required max="" />

    <label for="sendvia">Send Via</label>
    <select id="sendvia" name="sendvia" required>
      <option value="">-- Select Option --</option>
      <option value="sms">SMS</option>
      <option value="whatsapp">WhatsApp</option>
    </select>

    <div class="buttons">
      <button type="submit">Submit</button>
      <button type="button" onclick="document.getElementById('registrationForm').reset(); toggleDisabilityDesc();">Clear</button>
    </div>
  </form>
</div>

<script>
  // Populate counties and subcounties
  const countySubcounties = {
    "Mombasa": ["Mombasa Central", "Mvita", "Jomvu"],
    "Kwale": ["Matuga", "Kinango", "Lungalunga"],
    "Kilifi": ["Kilifi North", "Kilifi South", "Kaloleni", "Rabai"],
    "Tana River": ["Garsen", "Galole"],
    "Lamu": ["Lamu East", "Lamu West"],
    "Taita Taveta": ["Mwatate", "Voi", "Wundanyi"],
    "Garissa": ["Balambala", "Garissa Township", "Ijara", "Dadaab", "Fafi"],
    "Wajir": ["Wajir East", "Wajir West", "Eldas", "Tarba", "Habaswein"],
    "Mandera": ["Mandera East", "Mandera West", "Banisa", "Lafey", "Mandera North"],
    "Marsabit": ["North Horr", "Saku", "Laisamis"],
    "Isiolo": ["Isiolo North", "Isiolo South"],
    "Meru": ["Imenti North", "Imenti South", "Igembe Central", "Igembe North", "Igembe South", "Tigania East", "Tigania West"],
    "Tharaka Nithi": ["Chuka", "Maara", "Tharaka"],
    "Embu": ["Manyatta", "Runyenjes", "Mbeere North", "Mbeere South"],
    "Kitui": ["Kitui Central", "Kitui Rural", "Mutitu", "Mwingi North", "Mwingi West"],
    "Machakos": ["Machakos Town", "Mavoko", "Mwala", "Yatta", "Kathiani"],
    "Makueni": ["Makueni", "Kaiti", "Kibwezi West", "Kibwezi East", "Mbooni"],
    "Nyandarua": ["Ol Kalou", "Ndaragwa", "Kinangop"],
    "Nyeri": ["Tetu", "Kieni", "Mathira", "Othaya", "Mukurweini", "Nyeri Town"],
    "Kirinyaga": ["Mwea", "Kirinyaga East", "Kirinyaga Central", "Kirinyaga West"],
    "Murang'a": ["Kangema", "Kigumo", "Kandara", "Kiharu", "Mathioya", "Maragwa"],
    "Kiambu": ["Gatundu North", "Gatundu South", "Kiambaa", "Kabete", "Limuru", "Thika Town", "Ruiru", "Juja", "Githunguri", "Kiambu"],
    "Turkana": ["Loima", "Turkana Central", "Turkana North", "Turkana South", "Turkana East"],
    "West Pokot": ["Pokot South", "Pokot Central", "Pokot North", "Sigor"],
    "Samburu": ["Samburu East", "Samburu North", "Samburu West"],
    "Trans Nzoia": ["Kwanza", "Saboti", "Kiminini", "Endebess"],
    "Uasin Gishu": ["Turbo", "Kapseret", "Kesses"],
    "Elgeyo-Marakwet": ["Keiyo North", "Keiyo South", "Marakwet East", "Marakwet West"],
    "Nandi": ["Aldai", "Chesumei", "Nandi Hills", "Tinderet", "Nandi Central"],
    "Baringo": ["Mogotio", "Baringo Central", "Eldama Ravine", "Baringo North", "Tiaty"],
    "Laikipia": ["Laikipia East", "Laikipia North", "Laikipia West"],
    "Nakuru": ["Nakuru East", "Nakuru West", "Naivasha", "Gilgil", "Kuresoi North", "Kuresoi South"],
    "Narok": ["Narok North", "Narok East", "Narok South", "Narok West", "Emurua Dikirr", "Kilgoris"],
    "Kajiado": ["Kajiado North", "Kajiado West", "Kajiado Central", "Kajiado East", "Kajiado South"],
    "Kericho": ["Ainamoi", "Belgut", "Buret", "Londiani", "Soin"],
    "Bomet": ["Bomet Central", "Chepalungu", "Sotik", "Bomet East"],
    "Kakamega": ["Lurambi", "Malava", "Ikolomani", "Mumias East", "Mumias West", "Navakholo", "Shinyalu"],
    "Vihiga": ["Emuhaya", "Hamisi", "Sabatia", "Vihiga"],
    "Bungoma": ["Kimilili", "Bungoma East", "Bungoma North", "Bungoma South", "Bungoma West", "Mt. Elgon"],
    "Busia": ["Matayos", "Nambale", "Butula", "Funyula", "Teso North", "Teso South"],
    "Siaya": ["Ugenya", "Bondo", "Gem", "Rarieda", "Alego Usonga"],
    "Kisumu": ["Kisumu West", "Kisumu East", "Kisumu Central", "Seme", "Nyando"],
    "Homa Bay": ["Homa Bay Town", "Kabondo Kasipul", "Ndhiwa", "Rangwe", "Suba North", "Suba South"],
    "Migori": ["Suna East", "Suna West", "Awendo", "Rongo", "Uriri", "Kuria West", "Kuria East"],
    "Kisii": ["Kisii Central", "Bobasi", "Bonchari", "Nyaribari Chache", "Nyaribari Masaba", "South Mugirango"],
    "Nyamira": ["Nyamira North", "Nyamira South", "Borabu"],
    "Nairobi": ["Dagoretti North", "Dagoretti South", "Lang'ata", "Kibra", "Westlands", "Kasarani", "Ruaraka", "Embakasi North", "Embakasi East", "Embakasi South", "Embakasi West", "Makadara", "Kamukunji", "Starehe", "Mathare"]
  };

  function populateCounties() {
    const countySelect = document.getElementById('county');
    Object.keys(countySubcounties).forEach(county => {
      const option = document.createElement('option');
      option.value = county;
      option.textContent = county;
      countySelect.appendChild(option);
    });
  }

  function populateSubcounties() {
    const countySelect = document.getElementById('county');
    const subcountySelect = document.getElementById('subcounty');
    const selectedCounty = countySelect.value;

    subcountySelect.innerHTML = '<option value="">-- Select Subcounty --</option>';

    if (selectedCounty && countySubcounties[selectedCounty]) {
      countySubcounties[selectedCounty].forEach(sc => {
        const option = document.createElement('option');
        option.value = sc;
        option.textContent = sc;
        subcountySelect.appendChild(option);
      });
    }
  }

  function toggleDisabilityDesc() {
    const disability = document.getElementById('disability').value;
    const descLabel = document.getElementById('disabilitydesc-label');
    const descTextarea = document.getElementById('disabilitydesc');

    if (disability === 'Yes') {
      descLabel.style.display = 'block';
      descTextarea.style.display = 'block';
      descTextarea.setAttribute('required', 'required');
    } else {
      descLabel.style.display = 'none';
      descTextarea.style.display = 'none';
      descTextarea.removeAttribute('required');
    }
  }

  // Set max registration date to today
  function setMaxRegDate() {
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('regdate').setAttribute('max', today);
  }

  setMaxRegDate();
  populateCounties();

  function encodeForSMS(text) {
    return encodeURIComponent(text).replace(/%0A/g, '\n');
  }

  function handleSubmit(event) {
    event.preventDefault();

    const form = document.getElementById('registrationForm');
    if (!form.checkValidity()) {
      form.reportValidity();
      return false;
    }

    const data = {
      fullname: form.fullname.value.trim(),
      gender: form.gender.value,
      age: form.age.value,
      religion: form.religion.value.trim(),
      education: form.education.value,
      profession: form.profession.value,
      county: form.county.value,
      subcounty: form.subcounty.value,
      ward: form.ward.value.trim(),
      location: form.location.value.trim(),
      sublocation: form.sublocation.value.trim(),
      disability: form.disability.value,
      disabilitydesc: form.disabilitydesc.value.trim(),
      nokname: form.nokname.value.trim(),
      nokcontact: form.nokcontact.value.trim(),
      nationalid: form.nationalid.value.trim(),
      regdate: form.regdate.value,
      sendvia: form.sendvia.value
    };

    let msg = `SAGOMA CBO Registration Form Submission:\n`;
    msg += `Full Name: ${data.fullname}\n`;
    msg += `Gender: ${data.gender}\n`;
    msg += `Age: ${data.age}\n`;
    msg += `Religion: ${data.religion}\n`;
    msg += `Education Level: ${data.education}\n`;
    msg += `Profession: ${data.profession}\n`;
    msg += `County: ${data.county}\n`;
    msg += `Subcounty: ${data.subcounty}\n`;
    msg += `Ward: ${data.ward}\n`;
    msg += `Location: ${data.location}\n`;
    msg += `Sub Location: ${data.sublocation}\n`;
    msg += `Disability: ${data.disability}\n`;
    if(data.disability === 'Yes') {
      msg += `Disability Description: ${data.disabilitydesc}\n`;
    }
    msg += `Next of Kin Name: ${data.nokname}\n`;
    msg += `Next of Kin Contact: ${data.nokcontact}\n`;
    msg += `National ID Number: ${data.nationalid}\n`;
    msg += `Registration Date: ${data.regdate}\n`;

    // Replace these numbers with the actual phone numbers
    const smsNumber = "0704952434";       // For SMS
    const whatsappNumber = "254704952434"; // For WhatsApp in international format (no +)

    const mainWebsiteURL = "https://your-main-website.com"; // Change this to your website

    if (data.sendvia === 'sms') {
      const smsBody = encodeForSMS(msg);
      const smsLink = `sms:${smsNumber}?body=${smsBody}`;
      window.location.href = smsLink;
      alert("Form submitted via SMS successfully!");
    } else if(data.sendvia === 'whatsapp') {
      const waMessage = encodeURIComponent(msg);
      const waLink = `https://wa.me/${whatsappNumber}?text=${waMessage}`;
      window.open(waLink, '_blank');
      alert("Form submitted via WhatsApp successfully!");
    }

    form.reset();
    toggleDisabilityDesc(); // Hide disability desc if any
    setTimeout(() => {
      window.location.href = mainWebsiteURL;
    }, 3000);

    return false;
  }
</script>

</body>
</html>
